<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Application Site</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- For AJAX -->
    <script src="/static/scripts.js"></script> <!-- Link to your external JS file -->
    <link rel="stylesheet" href="/static/style.css"> <!-- For styling the page -->
</head>
<body>
     <h1>Job List:</h1>
    <table>
        <tr>
            <th>ID</th>
            <th>Job Title</th>
            <th>Job Rate</th>
            <th>Applied</th>
            <th>Link</th>
        </tr>

        <!-- Job rows will be inserted here into the placeholder: -->
        {% for job in jobs %} <!-- jobs is passed in from rust code. -->
        <!-- The data for each job object is extracted and added to a table row: -->
        <tr {% if job.applied %} class="highlight-green" {% else %} class="highlight-red" {% endif %}>
            <td>{{ job.id }}</td>
            <td>{{ job.title }}</td>
            <td>${{ job.hourly }}</td>
            <td><span class="applied-status" data-job-id="{{ job.id }}" onclick="toggleAppliedStatus(this)">
                {% if job.applied is not defined %}
                    No Data
                {% elif job.applied %}
                    Yes
                {% else %}
                    No
                {% endif %}
                </span>
            </td>
            {% if job.link and job.link != "No Link" %}
                <td><a href="{{ job.link }}" target="_blank">Link to Job</a></td>
            {% else %}
              <td>No link</td>
            {% endif %}
        </tr>
        {% endfor %}
    </table>   

    <button id="addJobBtn">Add a Job</button>
    <button id="removeJobBtn">Remove a Job</button>

    <!-- Placeholder for dynamically loaded "add job" form -->
    <div id="addJobForm" style="display:none;">
        <h2>Add a Job</h2>
        <form action="/add" method="POST">
            <label for="title">Job Title</label>
            <input type="text" id="title" name="title" required><br><br>

            <label for="hourly">Hourly Rate</label>
            <input type="number" id="hourly" name="hourly" required><br><br>

            <label for="applied">Applied</label>
            <select id="applied" name="applied" required>
                <option value="No" {% if job.applied is not defined %}selected{% endif %}>No</option>
                <option value="Yes" {% if job.applied == "Yes" %}selected{% endif %}>Yes</option>
                <option value="No" {% if not job.applied == "No" %}selected{% endif %}>No</option>
            </select><br><br>

            <label for="link">Link</label>
            <input type="url" id="link" name="link"><br><br>

            <button type="submit">Add Job</button>
        </form>
    </div>

    <!-- Placeholder for the remove job form -->
    <div id="removeJobForm" style="display:none;">
        {% if message %}
            <p style="color: {% if success %}green{% else %}red{% endif %};">
                {{ message }}
            </p>
        {% endif %}

        <h2>Remove a Job</h2>
        <form action="/rem" method="POST">
            <label for="id">Enter Job ID to Remove:</label>
            <input type="number" id="id" name="id" required>
            <button type="submit">Remove Job</button>
        </form>
    </div>

</body>
</html>
